package toMovie;
import java.sql.*;
import java.util.*;

@SuppressWarnings("unused")
public class MovieDao {
	//connection to database
	public static Connection getConnection(){
		Connection con = null;
		try {
			Class.forName("com.mysql.cj.jdbc.Driver");
			con = DriverManager.getConnection("jdbc:mysql://localhost:3306/cs157aprojectteam6","root","Halo4mlg!");	
		}catch(SQLException | ClassNotFoundException e) {
		e.printStackTrace();
		}
		return con;
	}
	
	//Method gets Watchlist
	public static List<MovieList>getWatchlist(){
		List<MovieList> list = new ArrayList<MovieList>();
		try {
			Connection con = MovieDao.getConnection();
			PreparedStatement ar = con.prepareStatement("SELECT * FROM `cs157aprojectteam6`.`WatchList`");
			ResultSet rs = ar.executeQuery();
			while(rs.next()) {
				MovieList w = new MovieList();
				w.setListID(rs.getInt(1));
				w.setTitle(rs.getString(2));
				w.setStatus(rs.getString(3));
				list.add(w);
			}
			con.close();
		}catch(Exception e) {
			e.printStackTrace();
		}
		return list;
	}
	//Method gets Movie Information
		public static List<MovieList>getMovieCatalog(){
			List<MovieList> list = new ArrayList<MovieList>();
			try {
				Connection con = MovieDao.getConnection();
				PreparedStatement ar = con.prepareStatement("SELECT * FROM `cs157aprojectteam6`.`WatchList`");
				ResultSet rs = ar.executeQuery();
				while(rs.next()) {
					MovieList w = new MovieList();
					w.setListID(rs.getInt(1));
					w.setTitle(rs.getString(2));
					w.setStatus(rs.getString(3));
					list.add(w);
				}
				con.close();
			}catch(Exception e) {
				e.printStackTrace();
			}
			return list;
		}
}

	
	//inserting film to watchlist
	//public void insertMovie(MovieList movie)throws SQLException, ClassNotFoundException {
	//String UPDATE_WATCHLIST = "INSERT INTO `cs157aprojectteam6`.`WatchList` (`listID`, `title`, `status`) VALUES ('?', '?', '?')";
	
	//connection to database

	//creating statement using connection object
	//PreparedStatement preparedStatement =  connection.prepareStatement(UPDATE_WATCHLIST)){
	//preparedStatement.setInt(1,movie.getListID());
	//preparedStatement.setString(2,movie.getTitle());
	//preparedStatement.setString(3, movie.getStatus());
	//System.out.println(preparedStatement);